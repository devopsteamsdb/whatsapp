<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsappAPI - WhatsApp HTTP API</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M16 0C7.163 0 0 7.163 0 16c0 2.825.734 5.48 2.02 7.784L0 32l8.416-2.02A15.923 15.923 0 0016 32c8.837 0 16-7.163 16-16S24.837 0 16 0z"
                        fill="#25D366" />
                    <path
                        d="M25.6 22.4c-.8 2.267-4 4.134-6.534 4.667-1.466.267-3.2.4-9.333-2-7.2-2.8-11.867-10.133-12.267-10.667-.4-.533-3.2-4.267-3.2-8.133 0-3.867 2-5.734 2.8-6.534.667-.666 1.734-1.066 2.8-1.066.267 0 .533.133.8.133.8 0 1.2.134 1.733 1.334.667 1.466 2.267 5.466 2.4 5.866.134.4.267.934 0 1.467-.266.667-.533 1.067-.933 1.6-.4.534-.8.934-1.2 1.467-.4.4-.8.933-.267 1.733.534.8 2.267 3.734 4.934 6.134 3.466 3.066 6.266 4 7.2 4.533.8.4 1.6.267 2.133-.4.667-.8 1.467-2.133 2.267-3.466.533-.8 1.2-.934 2-.534.8.4 5.066 2.4 5.866 2.8.8.4 1.334.667 1.6 1.067.267.533.267 2-.533 4.133z"
                        fill="#fff" />
                </svg>
                <h1>WhatsappAPI</h1>
            </div>
            <div class="status-badge" id="statusBadge">
                <span class="status-dot"></span>
                <span class="status-text">Not Connected</span>

                <!-- Dropdown for connected state -->
                <div class="status-dropdown" id="statusDropdown" style="display: none;">
                    <div class="dropdown-content">
                        <div class="session-detail">
                            <span class="detail-label">Phone:</span>
                            <span class="detail-value" id="headerPhone">-</span>
                        </div>
                        <div class="session-detail">
                            <span class="detail-label">Name:</span>
                            <span class="detail-value" id="headerName">-</span>
                        </div>
                        <div class="session-detail">
                            <span class="detail-label">Platform:</span>
                            <span class="detail-value" id="headerPlatform">-</span>
                        </div>
                        <button id="headerLogoutBtn" class="dropdown-btn">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                                <polyline points="16 17 21 12 16 7" />
                                <line x1="21" y1="12" x2="9" y2="12" />
                            </svg>
                            Logout
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Session Card (shown only when not connected) -->
            <div class="card session-card" id="sessionCard">
                <div class="card-header">
                    <h2>Session Management</h2>
                    <p class="card-subtitle">Connect your WhatsApp account</p>
                </div>
                <div class="card-body">
                    <div id="qrSection" class="qr-section">
                        <div class="qr-placeholder" id="qrPlaceholder">
                            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <rect x="3" y="3" width="7" height="7" />
                                <rect x="14" y="3" width="7" height="7" />
                                <rect x="14" y="14" width="7" height="7" />
                                <rect x="3" y="14" width="7" height="7" />
                            </svg>
                            <p>Click "Start Session" to generate QR code</p>
                        </div>
                        <img id="qrImage" class="qr-image" style="display: none;" alt="QR Code">
                    </div>

                    <div class="button-group">
                        <button id="startSessionBtn" class="btn btn-primary">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="12" cy="12" r="10" />
                                <polygon points="10 8 16 12 10 16 10 8" />
                            </svg>
                            Start Session
                        </button>
                    </div>
                </div>
            </div>

            <!-- Message Sending Card -->
            <div class="card message-card">
                <div class="card-header">
                    <h2>Send Message</h2>
                    <p class="card-subtitle">Send WhatsApp messages via API</p>
                </div>
                <div class="card-body">
                    <form id="messageForm">
                        <div class="form-group">
                            <label for="phoneInput">Phone Number</label>
                            <input type="text" id="phoneInput" class="form-input" placeholder="e.g., 972501234567"
                                required>
                            <small class="form-hint">Include country code without + or spaces</small>
                        </div>
                        <div class="form-group">
                            <label for="messageInput">Message</label>
                            <textarea id="messageInput" class="form-textarea" rows="3"
                                placeholder="Type your message here..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Attach Media (optional)</label>
                            <div class="image-upload-wrapper">
                                <input type="file" id="imageInput" accept="image/*,video/*" class="image-input">
                                <label for="imageInput" class="image-upload-label">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                                        <circle cx="8.5" cy="8.5" r="1.5" />
                                        <polyline points="21 15 16 10 5 21" />
                                    </svg>
                                    <span id="imageFileName">Choose media...</span>
                                </label>
                                <button type="button" id="clearImageBtn" class="clear-image-btn" style="display: none;">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <line x1="18" y1="6" x2="6" y2="18" />
                                        <line x1="6" y1="6" x2="18" y2="18" />
                                    </svg>
                                </button>
                            </div>
                            <div id="mediaPreviewContainer" style="display: none; margin-top: 10px;">
                                <img id="imagePreview" class="image-preview" style="display: none;">
                                <video id="videoPreview" class="image-preview" controls
                                    style="display: none; max-width: 100%; max-height: 200px; border-radius: 8px;"></video>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block" id="sendMessageBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <line x1="22" y1="2" x2="11" y2="13" />
                                <polygon points="22 2 15 22 11 13 2 9 22 2" />
                            </svg>
                            Send Message
                        </button>
                    </form>

                    <div id="messageResult" class="message-result" style="display: none;"></div>
                </div>
            </div>

            <!-- Bot Configuration Card -->
            <div class="card bot-card">
                <div class="card-header">
                    <h2>WhatsApp Bot</h2>
                    <p class="card-subtitle">Automated message responses</p>
                </div>
                <div class="card-body">
                    <div class="toggle-group">
                        <div class="toggle-item">
                            <label class="toggle-label">
                                <span>Enable Bot</span>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="botEnabledToggle">
                                    <span class="toggle-slider"></span>
                                </div>
                            </label>
                        </div>
                        <div class="toggle-item">
                            <label class="toggle-label">
                                <span>Use AI Responses (Gemini)</span>
                                <div class="toggle-switch">
                                    <input type="checkbox" id="botAIToggle">
                                    <span class="toggle-slider"></span>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div class="system-instruction-section"
                        style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
                        <h3>AI System Instruction</h3>
                        <p class="text-sm text-gray margin-bottom-sm">Teach the bot how to behave (e.g., "You are a
                            pirate").</p>
                        <textarea id="systemInstructionInput" class="form-textarea" rows="4"
                            placeholder="Enter system instructions..."></textarea>
                    </div>

                    <div class="patterns-section">
                        <h3>Reply Patterns</h3>
                        <div id="patternsList" class="patterns-list"></div>

                        <div class="add-pattern-form">
                            <input type="text" id="patternTrigger" class="form-input"
                                placeholder="Trigger word (e.g., hello)">
                            <input type="text" id="patternResponse" class="form-input" placeholder="Response message">
                            <button id="addPatternBtn" class="btn btn-secondary">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19" />
                                    <line x1="5" y1="12" x2="19" y2="12" />
                                </svg>
                                Add Pattern
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>WhatsappAPI - Powered by whatsapp-web.js</p>
        </footer>
    </div>

    <script src="/js/app.js"></script>
</body>

</html>